#!/bin/bash

# prompt for sudo first
sudo echo -n ""

# updates from debian repos
echo -e $(tput setaf 3)Updates from Debian repos $(tput setaf 7)
sudo apt update
sudo apt full-upgrade -y
sudo apt autoremove -y

# update kernel from debian backports repo
echo -e $(tput setaf 3)Update kernel from Debian backports repo $(tput setaf 7)
sudo apt update -t trixie-backports
sudo apt install -y -t trixie-backports linux-image-amd64

# delete residual config files
dpkg -l | grep '^rc' | awk '{print $2}' | xargs sudo apt-get purge -y

# delete unused flatpaks
echo -e $(tput setaf 3)Delete unused Flatpaks $(tput setaf 7)
flatpak uninstall --unused --delete-data -y

# update flatpaks
echo -e $(tput setaf 3)Update Flatpaks $(tput setaf 7)
flatpak update -y

# update firmware
echo -e $(tput setaf 3)Update Firmware $(tput setaf 7)
fwupdmgr refresh --force
fwupdmgr update

# cd into manas folder
cd ~/.local/share/manas

# update direct-download apps
echo -e $(tput setaf 3)Update direct-download apps $(tput setaf 7)
./manas update-apps 

# update manas
echo -e $(tput setaf 3)Update Manas $(tput setaf 7)
git pull

cd -
